name: ytrss public instance
run-name: ${{ github.actor }} is running ytrss
on:
  schedule:
  - cron: "0 0 */3 * *"
jobs:
  runs-on: ubuntu-latest
  - name: Setup Python
    uses: actions/setup-python@v4.5.0
    with:
      # Version range or exact version of Python or PyPy to use, using SemVer's version range syntax. Reads from .python-version if unset.
      python-version: # optional
      # File containing the Python version to use. Example: .python-version
      python-version-file: # optional
      # Used to specify a package manager for caching in the default directory. Supported values: pip, pipenv, poetry.
      cache: # optional
      # The target architecture (x86, x64) of the Python or PyPy interpreter.
      architecture: # optional
      # Set this option if you want the action to check for the latest available version that satisfies the version spec.
      check-latest: # optional
      # The token used to authenticate when fetching Python distributions from https://github.com/actions/python-versions. When running this action on github.com, the default value is sufficient. When running on GHES, you can pass a personal access token for github.com if you are experiencing rate limiting.
      token: # optional, default is ${{ github.server_url == 'https://github.com' && github.token || '' }}
      # Used to specify the path to dependency files. Supports wildcards or a list of file names for caching multiple dependencies.
      cache-dependency-path: # optional
      # Set this option if you want the action to update environment variables.
      update-environment: # optional, default is true
- name: Install Python requirements
  # You may pin to the exact commit or the version.
  # uses: aabadie/action-install-python-requirements@bd1357189566c9678a47677d561b4b8e113d9787
  uses: aabadie/action-install-python-requirements@v2.0.1
  with:
    # requirements text file
    requirements: # default is requirements.txt
    # Whether pip also has to be updated
    update-pip: 
run: python orc.py
run: rm -rf ./feed
run: mkdir feed
run: mv *.rss ./feed/
    env:
      ACCESS_TOKEN: ${{ secrets.ACCESS_TOKEN }}
      GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
      EXCLUDED: ${{ secrets.EXCLUDED }}
      EXCLUDED_LANGS: ${{ secrets.EXCLUDED_LANGS }}
      EXCLUDE_FORKED_REPOS: true

    # Commits all changed files to the repository
    - name: Commit to the repo
      run: |
        git config --global user.name "randomytbot"
        git config --global user.email "randomyt[bot]@tusharhero.github.io"
        git add ./feed/*
        # "echo" returns true so the build succeeds, even if no changed files
        git commit -am 'update feeds' || echo
        git push
